# 🖼️ AIPixels 갤러리 관리 및 커뮤니티 공유 화면 기능 명세서

---

## 1. 페이지 개요

### 🎯 페이지 목적
- **개인 갤러리 관리**: 사용자가 생성한 이미지들을 체계적으로 관리하고 편집
- **공개/비공개 전환**: 개인 갤러리와 커뮤니티 공유 간의 유연한 전환 제공
- **메타데이터 관리**: 이미지의 제목, 설명, 태그, 카테고리 수정 및 관리
- **커뮤니티 상호작용**: 공개된 이미지에 대한 피드백 및 통계 확인
- **이미지 공유**: 소셜 미디어 및 외부 플랫폼으로 이미지 공유 기능

### 🔗 라우팅 및 연동
- **경로**: `/gallery`
- **이미지 생성 페이지 연동**: 생성된 이미지가 자동으로 갤러리에 추가
- **커뮤니티 피드 연동**: 공개 설정 시 피드에 자동 게시
- **네비게이션**: 메인페이지, 이미지 생성, 피드 페이지로 이동 가능
- **Header 컴포넌트**: 통합된 헤더 컴포넌트 사용으로 일관된 네비게이션

---

## 2. 프론트엔드 기능 명세

### 🔹 레이아웃 구조

#### 📱 전체 화면 구성
```
+-----------------------------------------------+
| [Header: AIPixels 로고 + 네비게이션 + 크레딧]   |
+-----------------------------------------------+
| [탭 메뉴: 내 갤러리 | 공개 이미지]              |
+-----------------------------------------------+
| [필터 및 검색 영역]                             |
| - 검색창 | 카테고리 드롭다운 | 정렬 옵션        |
| - 태그 필터 (최대 20개 표시)                   |
| - 선택된 태그 표시                             |
+-----------------------------------------------+
| [이미지 그리드 영역] (더 보기 버튼)              |
| - 2x3x4 그리드 레이아웃 (반응형)                |
| - 각 이미지 카드: 썸네일 + 메타데이터 + 액션    |
| - 호버 시 액션 버튼 표시                       |
+-----------------------------------------------+
| [상세보기 모달] (이미지 클릭 시)                 |
| - 큰 이미지 + 편집 폼 + 액션 버튼              |
| - 공유 모달 연동                               |
+-----------------------------------------------+
| [푸터: 글래스모피즘 디자인]                    |
+-----------------------------------------------+
```

### 🔹 UI 컴포넌트 상세

#### 🗂️ 탭 메뉴 영역
- **내 갤러리 탭**:
  - 개인 갤러리의 모든 이미지 표시 (공개/비공개 포함)
  - 이미지 개수 표시: "내 갤러리 (24개)"
  - 기본 선택 탭
- **공개 이미지 탭**:
  - 커뮤니티에 공개된 이미지만 표시
  - 좋아요/댓글 수 표시: "공개 이미지 (12개) - 총 156 좋아요"
  - 공개 상태 전환 기능 포함

#### 🔍 필터 및 검색 영역
- **검색창**:
  - 이미지 제목, 설명, 태그로 통합 검색
  - 실시간 검색 (입력 시 즉시 필터링)
  - 플레이스홀더: "이미지 제목, 설명, 태그로 검색..."
- **카테고리 드롭다운**:
  - 전체, 인물, 풍경, 동물, 건축, 추상, 기타
  - 단일 선택 (select 드롭다운)
- **정렬 옵션**:
  - 최신순, 오래된순, 좋아요순, 제목순
  - select 드롭다운으로 선택
- **태그 필터**:
  - 사용 가능한 태그 최대 20개 표시
  - 클릭으로 태그 추가/제거
  - 선택된 태그는 별도 영역에 표시

#### 🖼️ 이미지 그리드 영역
- **그리드 레이아웃**:
  - 데스크톱: 4열, 태블릿: 3열, 모바일: 2열
  - 반응형 그리드 (CSS Grid 사용)
  - 이미지 비율: 1:1 (정사각형)
- **이미지 카드 구성**:
  ```
  +-------------------+
  | [썸네일 이미지]     |
  | (aspect-square)   |
  | [상태 배지]        |
  | [액션 버튼들]      |
  +-------------------+
  | [제목] (최대 2줄)  |
  | [태그] (최대 3개)  |
  | [통계 + 날짜]      |
  +-------------------+
  ```

#### 📋 이미지 카드 상세
- **썸네일**:
  - aspect-square (1:1 비율), 라운드 코너(12px)
  - 호버 시 확대 효과 (1.05배 스케일)
  - 로딩 상태: 스켈레톤 UI
- **상태 배지**:
  - 공개: 초록색 배지 + "공개"
  - 비공개: 회색 배지 + "비공개"
  - 좌상단에 위치
- **액션 버튼들** (호버 시 표시):
  - 공유 버튼 (📤): 이미지 공유 모달 열기
  - 공개/비공개 전환 (🌐/🔒): 상태 토글
  - 삭제 버튼 (🗑️): 이미지 삭제
  - 우상단에 위치
- **제목**:
  - 최대 2줄, 넘칠 시 "..." 표시
  - 클릭 시 상세보기 모달 열림
  - 호버 시 파란색으로 변경
- **태그 표시**:
  - 최대 3개 태그, 넘칠 시 "+N" 표시
  - 각 태그: pill 형태, 작은 크기
- **통계 및 날짜**:
  - 조회수 (👁️), 좋아요 (❤️), 댓글 (💬)
  - 생성 날짜 (우측 정렬)

#### 🔍 상세보기 모달
- **모달 크기**: 화면의 80% (최대 1200px)
- **레이아웃**: 좌측 이미지 + 우측 편집 폼
- **이미지 영역**:
  - 큰 이미지 (최대 600px)
  - 확대/축소 기능
  - 다운로드 버튼
- **편집 폼 영역**:
  - 제목, 설명, 태그, 카테고리 수정
  - 실시간 저장 (자동 저장)
  - 공개/비공개 전환 토글
  - 통계 정보 (조회수, 좋아요, 댓글)
- **액션 버튼들**:
  - 편집 모드 토글
  - 공개/비공개 전환
  - 이미지 삭제
  - 공유 모달 열기
- **공유 모달 연동**:
  - 소셜 미디어 공유 (트위터, 페이스북, 인스타그램)
  - 링크 복사 기능
  - 다운로드 옵션

### 🔹 사용자 인터랙션 플로우

#### 📋 기본 갤러리 관리 플로우
1. **페이지 진입**: 내 갤러리 탭이 기본 선택되어 표시
2. **이미지 탐색**: "더 보기" 버튼으로 이미지 목록 확인
3. **필터링**: 검색창, 태그/카테고리로 원하는 이미지 검색
4. **상세보기**: 이미지 클릭하여 모달에서 상세 정보 확인
5. **편집**: 제목, 설명, 태그, 카테고리 수정
6. **상태 변경**: 공개/비공개 전환
7. **삭제**: 불필요한 이미지 삭제
8. **공유**: 이미지를 소셜 미디어로 공유

#### ⚡ 실시간 상호작용
- **검색**: 입력 시 즉시 필터링 결과 표시
- **편집**: 폼 수정 시 자동 저장 (3초 후)
- **상태 전환**: 토글 클릭 시 즉시 상태 변경
- **더 보기**: 버튼 클릭으로 다음 페이지 로드
- **호버 효과**: 이미지 카드 호버 시 액션 버튼 표시

#### 🔄 공개/비공개 전환 플로우
1. **상태 확인**: 현재 공개/비공개 상태 표시
2. **전환 요청**: 토글 버튼 클릭
3. **확인 다이얼로그**: "이미지를 공개하시겠습니까?" 메시지
4. **처리**: 백엔드에서 상태 변경 및 피드 업데이트
5. **피드백**: 성공/실패 토스트 메시지 표시

---

## 3. 백엔드 기능 명세

### 🔹 API 엔드포인트

#### 🖼️ 갤러리 조회
- **`GET /api/gallery`**
  - 쿼리 파라미터:
    ```
    ?userId=string&tab=private|public&page=number&limit=number
    &tags=string[]&category=string&sortBy=latest|oldest|likes|title
    &searchQuery=string
    ```
  - 응답:
    ```json
    {
      "success": true,
      "data": {
        "images": [
          {
            "id": "string",
            "title": "string",
            "description": "string",
            "tags": ["string"],
            "category": "string",
            "thumbnailUrl": "string",
            "imageUrl": "string",
            "isPublic": boolean,
            "createdAt": "string",
            "updatedAt": "string",
            "stats": {
              "views": number,
              "likes": number,
              "comments": number
            }
          }
        ],
        "pagination": {
          "currentPage": number,
          "totalPages": number,
          "totalItems": number,
          "hasNext": boolean
        },
        "filters": {
          "availableTags": ["string"],
          "availableCategories": ["string"]
        }
      }
    }
    ```

#### ✏️ 이미지 편집
- **`PUT /api/gallery/{id}`**
  - 요청 파라미터:
    ```json
    {
      "title": "string (50자 이하)",
      "description": "string (200자 이하)",
      "tags": ["string"],
      "category": "string"
    }
    ```
  - 응답:
    ```json
    {
      "success": true,
      "message": "이미지 정보가 수정되었습니다.",
      "data": {
        "id": "string",
        "updatedAt": "string"
      }
    }
    ```

#### 🔄 공개 상태 전환
- **`POST /api/gallery/{id}/visibility`**
  - 요청 파라미터:
    ```json
    {
      "isPublic": boolean
    }
    ```
  - 응답:
    ```json
    {
      "success": true,
      "message": "이미지가 공개되었습니다.",
      "data": {
        "id": "string",
        "isPublic": boolean,
        "feedId": "string" // 공개 시 피드 ID 반환
      }
    }
    ```

#### 🗑️ 이미지 삭제
- **`DELETE /api/gallery/{id}`**
  - 응답:
    ```json
    {
      "success": true,
      "message": "이미지가 삭제되었습니다."
    }
    ```
  - **Soft Delete**: DB에서 삭제 플래그만 변경, 실제 파일은 30일 후 삭제

#### 🏷️ 메타데이터 관리
- **`GET /api/gallery/tags`**
  - 기능: 사용자의 모든 태그 목록 조회
  - 응답: 태그 이름과 사용 횟수
  
- **`GET /api/gallery/categories`**
  - 기능: 사용 가능한 카테고리 목록
  - 응답: 고정 카테고리 목록

#### 📤 이미지 공유
- **`POST /api/gallery/{id}/share`**
  - 기능: 이미지 공유 링크 생성
  - 요청 파라미터:
    ```json
    {
      "platform": "twitter|facebook|instagram|link",
      "message": "string (선택사항)"
    }
    ```
  - 응답:
    ```json
    {
      "success": true,
      "data": {
        "shareUrl": "string",
        "platform": "string"
      }
    }
    ```

### 🔹 데이터 처리 로직

#### 🔍 검색 및 필터링
- **태그 검색**: 부분 일치 검색 (LIKE 쿼리)
- **카테고리 필터**: 정확한 일치 검색
- **정렬**: 데이터베이스 레벨에서 정렬 처리
- **페이지네이션**: OFFSET/LIMIT 방식 사용

#### 📊 통계 데이터
- **조회수**: 이미지 상세보기 시 자동 증가
- **좋아요/댓글**: 피드 API에서 실시간 조회
- **캐싱**: 통계 데이터는 5분간 캐시

#### 🔒 권한 관리
- **소유권 검증**: 모든 갤러리 작업 시 사용자 ID 확인
- **공개 상태**: 공개 이미지만 피드에 노출
- **삭제 권한**: 본인 이미지만 삭제 가능

---

## 4. 상태 관리 및 에러 처리

### 🔹 상태 관리 (Redux/Zustand)

#### 📊 전역 상태 구조
```typescript
interface GalleryState {
  // 탭 관리
  activeTab: 'private' | 'public';
  
  // 이미지 데이터
  images: GalleryImage[];
  selectedImage: GalleryImage | null;
  
  // 필터 및 검색
  filters: {
    tags: string[];
    category: string;
    sortBy: 'latest' | 'oldest' | 'likes' | 'title';
    searchQuery: string;
  };
  
  // 페이지네이션
  pagination: {
    currentPage: number;
    hasNext: boolean;
    isLoading: boolean;
  };
  
  // 모달 상태
  isDetailModalOpen: boolean;
  isEditing: boolean;
  
  // 에러 상태
  error: string | null;
}
```

#### 🖼️ 이미지 데이터 타입
```typescript
interface GalleryImage {
  id: string;
  title: string;
  description: string;
  tags: string[];
  category: string;
  thumbnailUrl: string;
  imageUrl: string;
  isPublic: boolean;
  createdAt: string;
  updatedAt: string;
  stats: {
    views: number;
    likes: number;
    comments: number;
  };
}
```

### 🔹 에러 처리 시나리오

#### ❌ 데이터 로딩 에러
- **네트워크 오류**: "네트워크 연결을 확인하고 다시 시도해주세요."
- **서버 오류**: "일시적인 오류가 발생했습니다. 잠시 후 다시 시도해주세요."
- **권한 오류**: "로그인이 필요합니다."

#### ❌ 편집 관련 에러
- **저장 실패**: "저장에 실패했습니다. 다시 시도해주세요."
- **유효성 검사**: "제목은 50자 이하로 입력해주세요."
- **중복 태그**: "이미 추가된 태그입니다."

#### ❌ 상태 전환 에러
- **공개 전환 실패**: "공개 설정에 실패했습니다."
- **피드 업데이트 실패**: "피드 업데이트에 실패했습니다."

---

## 5. 성능 최적화 및 사용자 경험

### 🔹 성능 최적화

#### ⚡ 이미지 최적화
- **지연 로딩**: 뷰포트에 들어올 때만 이미지 로드
- **썸네일 캐싱**: 브라우저 캐시 활용
- **WebP 포맷**: 최신 브라우저에서 WebP 사용
- **적응형 크기**: 화면 크기에 따른 이미지 해상도 조정

#### 📱 페이지네이션 최적화
- **더 보기 버튼**: 무한 스크롤 대신 "더 보기" 버튼 사용
- **프리페칭**: 다음 페이지 데이터 사전 로드
- **메모리 관리**: 화면에서 벗어난 이미지 컴포넌트 언마운트

#### 🔍 검색 최적화
- **디바운싱**: 검색 입력 시 300ms 지연
- **캐싱**: 검색 결과 5분간 캐시
- **인덱싱**: 데이터베이스 태그/카테고리 인덱스 최적화

### 🔹 사용자 경험 개선

#### 🎨 시각적 피드백
- **로딩 상태**: 스켈레톤 UI로 로딩 중 표시
- **편집 상태**: 수정 중인 필드 하이라이트
- **상태 변경**: 토글 애니메이션으로 상태 변화 표시
- **성공/실패**: 토스트 메시지로 작업 결과 알림

#### ⌨️ 접근성
- **키보드 네비게이션**: Tab 키로 모든 요소 접근 가능
- **스크린 리더**: ARIA 라벨 및 역할 정의
- **색상 대비**: WCAG 2.1 AA 기준 준수
- **포커스 표시**: 키보드 포커스 시각적 표시

#### 📱 반응형 디자인
- **모바일**: 2열 그리드, 터치 친화적 버튼 크기
- **태블릿**: 3열 그리드, 적절한 간격 유지
- **데스크톱**: 4열 그리드, 호버 효과 활용

---

## 6. 보안 및 정책

### 🔹 보안 조치

#### 🛡️ 데이터 보호
- **소유권 검증**: 모든 갤러리 작업 시 사용자 ID 확인
- **입력 검증**: XSS 방지를 위한 HTML 태그 제거
- **파일 접근**: 이미지 파일 접근 권한 검증
- **API 보호**: Rate limiting 및 CSRF 토큰 검증

#### 🔒 개인정보 보호
- **최소 수집**: 이미지 메타데이터만 저장
- **자동 삭제**: 삭제된 이미지 30일 후 완전 삭제
- **로그 관리**: 접근 로그 최소화 및 정기 삭제

### 🔹 콘텐츠 정책

#### 📋 관리 정책
- **자동 저장**: 편집 내용 자동 저장으로 데이터 손실 방지
- **버전 관리**: 편집 이력 추적 (선택사항)
- **복구 기능**: 실수로 삭제한 이미지 복구 기능

---

## 7. 테스트 시나리오

### 🔹 기능 테스트

#### ✅ 기본 갤러리 관리 테스트
1. **탭 전환**: 내 갤러리 ↔ 공개 이미지 탭 전환 확인
2. **이미지 표시**: 그리드 레이아웃으로 이미지 정상 표시 확인
3. **필터링**: 검색창, 태그/카테고리 검색 정상 동작 확인
4. **정렬**: 최신순/오래된순/좋아요순 정렬 확인
5. **더 보기**: "더 보기" 버튼으로 다음 페이지 로드 확인
6. **호버 효과**: 이미지 카드 호버 시 액션 버튼 표시 확인

#### ✅ 편집 기능 테스트
1. **상세보기**: 이미지 클릭 시 모달 정상 열림 확인
2. **메타데이터 수정**: 제목/설명/태그/카테고리 수정 확인
3. **자동 저장**: 수정 내용 자동 저장 확인
4. **상태 전환**: 공개/비공개 전환 정상 동작 확인
5. **삭제**: 이미지 삭제 및 복구 확인
6. **공유 기능**: 이미지 공유 모달 및 소셜 미디어 공유 확인

#### ✅ 에러 처리 테스트
1. **네트워크 오류**: 오프라인 상태에서 적절한 에러 메시지 표시
2. **권한 오류**: 다른 사용자 이미지 접근 시 차단 확인
3. **입력 검증**: 잘못된 입력에 대한 즉시 피드백 확인
4. **서버 오류**: API 오류 시 재시도 옵션 제공 확인

### 🔹 성능 테스트

#### ⚡ 로딩 성능
- **페이지 로드**: 3초 이내 완료
- **이미지 로드**: 2초 이내 렌더링
- **검색 응답**: 1초 이내 결과 표시
- **편집 저장**: 500ms 이내 완료

#### 📱 반응형 테스트
- **모바일**: 320px~768px 화면에서 정상 동작
- **태블릿**: 768px~1024px 화면에서 정상 동작
- **데스크톱**: 1024px 이상 화면에서 정상 동작

---

## 8. 구현 우선순위

### ✅ Phase 1 (완료된 핵심 기능)
1. ✅ 기본 레이아웃 및 탭 메뉴
2. ✅ 이미지 그리드 표시 및 "더 보기" 버튼
3. ✅ 기본 필터링 (검색창, 태그/카테고리)
4. ✅ 상세보기 모달

### ✅ Phase 2 (완료된 편집 기능)
1. ✅ 메타데이터 편집 폼
2. ✅ 공개/비공개 상태 전환
3. ✅ 이미지 삭제 기능
4. ✅ 자동 저장 기능
5. ✅ 이미지 공유 기능

### 🔥 Phase 3 (추가 개선사항)
1. 성능 최적화 (지연 로딩, 캐싱)
2. 고급 검색 기능 (자동완성)
3. 접근성 개선
4. 사용자 경험 개선
5. 이미지 변형 생성 기능 연동

---

## 📋 협업 필요 사항

### 🔗 프론트엔드-백엔드 연동
- **API 스펙 정의**: 갤러리 CRUD API 상세 정의
- **이미지 처리**: 썸네일 생성 및 최적화 방식 협의
- **실시간 업데이트**: WebSocket 또는 Server-Sent Events 활용 방안

### 🎨 디자인 시스템
- **그리드 컴포넌트**: 재사용 가능한 이미지 그리드 컴포넌트
- **모달 시스템**: 일관된 모달 디자인 및 동작
- **반응형 브레이크포인트**: 갤러리 전용 반응형 기준점 설정

### 🔧 인프라 및 배포
- **이미지 CDN**: 빠른 이미지 로딩을 위한 CDN 설정
- **캐싱 전략**: Redis를 활용한 검색 결과 캐싱
- **모니터링**: 갤러리 사용량 및 성능 모니터링 도구 설정

---

## ✅ 최종 요약

* **갤러리 관리**: 개인 이미지의 체계적인 관리와 편집 기능 제공 ✅
* **공개/비공개 전환**: 유연한 공개 상태 관리로 커뮤니티 참여 조절 ✅
* **메타데이터 관리**: 제목, 설명, 태그, 카테고리의 완전한 편집 기능 ✅
* **검색 및 필터링**: 통합 검색창, 태그, 카테고리, 정렬을 통한 효율적인 이미지 탐색 ✅
* **이미지 공유**: 소셜 미디어 및 외부 플랫폼으로 이미지 공유 기능 ✅
* **반응형 디자인**: 모든 디바이스에서 최적화된 사용자 경험 ✅
* **호버 인터랙션**: 이미지 카드 호버 시 액션 버튼 표시로 직관적인 조작 ✅
* **Header 통합**: 통합된 헤더 컴포넌트로 일관된 네비게이션 ✅
* **성능 최적화**: "더 보기" 버튼을 통한 효율적인 페이지네이션 ✅
* **보안**: 사용자 데이터 보호 및 권한 관리 ✅
* **접근성**: 모든 사용자가 접근 가능한 인터페이스 제공 ✅
