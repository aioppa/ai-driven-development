# 🎨 AIPixels 이미지 생성 화면 기능 명세서

---

## 1. 페이지 개요

### 🎯 페이지 목적
- **AI 이미지 생성의 핵심 기능**: 사용자가 프롬프트와 스타일을 선택하여 고품질 AI 이미지를 생성
- **메인페이지 연동**: 메인페이지에서 입력한 프롬프트와 스타일을 초기값으로 설정
- **창작 워크플로우 완성**: 생성부터 저장/공유까지의 전체 프로세스 제공

### 🔗 라우팅 및 연동
- **경로**: `/generate`
- **메인페이지 연동**: 프롬프트/스타일 파라미터를 URL 쿼리 또는 상태로 전달받음
- **네비게이션**: 갤러리, 피드 페이지로 이동 가능

---

## 2. 프론트엔드 기능 명세

### 🔹 레이아웃 구조

#### 📱 전체 화면 구성
```
+-----------------------------------------------+
| [헤더: AIPixels 로고 + 네비게이션]              |
+-----------------------------------------------+
| [스타일 선택 영역] (5x5 그리드)                 |
+-----------------------------------------------+
| [프롬프트 입력 영역]                           |
| - 텍스트 입력 필드 (200자 제한)                |
| - [AI 이미지 생성] 버튼                       |
+-----------------------------------------------+
| [생성 결과 영역]                               |
| - 로딩 상태 표시                              |
| - 생성된 이미지 썸네일 리스트 (2x2 그리드)      |
| - 이미지 선택 인터랙션                        |
+-----------------------------------------------+
| [메타데이터 입력 영역] (이미지 선택 후 표시)      |
| - 제목 입력 필드                              |
| - 설명 입력 필드                              |
| - 태그 입력 (자동완성)                        |
| - 카테고리 선택 드롭다운                      |
+-----------------------------------------------+
| [액션 버튼 영역]                               |
| - [저장] [커뮤니티 공유] 버튼                  |
+-----------------------------------------------+
| [푸터: 글래스모피즘 디자인]                    |
+-----------------------------------------------+
```

### 🔹 UI 컴포넌트 상세

#### 🎨 스타일 선택 영역
- **레이아웃**: 5x5 그리드 (25개 스타일 옵션)
- **디자인**: 
  - 각 스타일 카드: 80x80px, 라운드 코너(8px)
  - 인기 스타일 강조: 파란색 테두리 + 별표 아이콘
  - 선택된 스타일: 파란색 배경 + 흰색 텍스트
- **상호작용**: 
  - 클릭 시 즉시 선택 상태 변경
  - 호버 시 미리보기 툴팁 표시
- **데이터**: 메인페이지에서 전달받은 스타일을 초기 선택값으로 설정

#### 📝 프롬프트 입력 영역
- **입력 필드**:
  - 크기: 전체 너비, 높이 120px
  - 스타일: 파란색 테두리, 그림자 효과, 둥근 모서리
  - 플레이스홀더: "원하는 이미지를 자세히 설명해주세요..."
  - 제한: 200자, 실시간 글자 수 표시
- **생성 버튼**:
  - 위치: 입력 필드 하단 중앙
  - 스타일: 파란색 배경, 흰색 텍스트, 16px 폰트
  - 상태: 기본/로딩/비활성화
  - 로딩 시: 스피너 + "생성 중..." 텍스트

#### 🖼️ 생성 결과 영역
- **로딩 상태**:
  - 스피너 애니메이션 (회전하는 원형)
  - "AI가 이미지를 생성하고 있습니다..." 메시지
  - 예상 소요 시간 표시 (30-60초)
- **결과 표시**:
  - 2x2 그리드 레이아웃 (4개 이미지)
  - 각 이미지: 200x200px, 라운드 코너(12px)
  - 호버 시 확대 효과 (1.05배 스케일)
  - 클릭 시 선택 상태 (파란색 테두리)

#### 📋 메타데이터 입력 영역
- **제목 입력**:
  - 필드 크기: 전체 너비, 높이 40px
  - 제한: 50자
  - 플레이스홀더: "이미지 제목을 입력하세요"
- **설명 입력**:
  - 필드 크기: 전체 너비, 높이 80px
  - 제한: 200자
  - 플레이스홀더: "이미지에 대한 설명을 입력하세요"
- **태그 입력**:
  - 자동완성 기능: 기존 태그 추천
  - 엔터로 태그 추가
  - 태그 표시: pill 형태, 회색 배경, x 버튼
  - 최대 10개 태그
- **카테고리 선택**:
  - 드롭다운 메뉴
  - 고정 카테고리: 인물, 풍경, 캐릭터, 배경, 추상, 기타
  - 다중 선택 불가

#### 🔘 액션 버튼 영역
- **저장 버튼**:
  - 스타일: 회색 배경, 검은색 텍스트
  - 기능: 개인 갤러리에 비공개로 저장
- **공유 버튼**:
  - 스타일: 파란색 배경, 흰색 텍스트
  - 기능: 커뮤니티 피드에 공개로 게시

### 🔹 사용자 인터랙션 플로우

#### 📋 기본 생성 플로우
1. **페이지 진입**: 메인페이지에서 프롬프트/스타일 전달받아 초기값 설정
2. **스타일 선택**: 5x5 그리드에서 원하는 스타일 클릭
3. **프롬프트 수정**: 필요시 프롬프트 텍스트 수정
4. **이미지 생성**: [AI 이미지 생성] 버튼 클릭
5. **결과 확인**: 4개 생성 이미지 중 원하는 이미지 선택
6. **메타데이터 입력**: 제목, 설명, 태그, 카테고리 입력
7. **저장/공유**: [저장] 또는 [커뮤니티 공유] 버튼 클릭

#### ⚡ 실시간 피드백
- **프롬프트 입력**: 실시간 글자 수 표시, 200자 초과 시 빨간색 경고
- **스타일 선택**: 즉시 시각적 피드백 (선택 상태 변경)
- **생성 진행**: 로딩 스피너 + 진행률 표시
- **결과 표시**: 페이드 인 애니메이션으로 이미지 등장
- **저장/공유**: 성공 시 녹색 토스트, 실패 시 빨간색 토스트

---

## 3. 백엔드 기능 명세

### 🔹 API 엔드포인트

#### 🎨 스타일 관리
- **`GET /api/styles`**
  - 기능: 사용 가능한 스타일 목록 조회
  - 응답: 25개 스타일 정보 (ID, 이름, 설명, 인기도, 미리보기 이미지)
  - 캐싱: 1시간 (스타일 변경 빈도 낮음)

#### 🤖 이미지 생성
- **`POST /api/generate`**
  - 요청 파라미터:
    ```json
    {
      "prompt": "string (200자 이하)",
      "styleId": "string",
      "userId": "string",
      "sessionId": "string"
    }
    ```
  - 응답:
    ```json
    {
      "success": true,
      "images": [
        {
          "id": "string",
          "url": "string",
          "thumbnailUrl": "string",
          "prompt": "string",
          "styleId": "string"
        }
      ],
      "generationTime": "number (초)",
      "remainingCredits": "number"
    }
    ```
  - 제한: 사용자당 일일 20회 무료 생성
  - 타임아웃: 120초

#### 💾 갤러리 저장
- **`POST /api/gallery/save`**
  - 요청 파라미터:
    ```json
    {
      "imageId": "string",
      "title": "string (50자 이하)",
      "description": "string (200자 이하)",
      "tags": ["string"],
      "category": "string",
      "isPublic": false
    }
    ```
  - 응답:
    ```json
    {
      "success": true,
      "galleryId": "string",
      "message": "이미지가 갤러리에 저장되었습니다."
    }
    ```

#### 🌐 커뮤니티 공유
- **`POST /api/gallery/share`**
  - 요청 파라미터: save와 동일하지만 `isPublic: true`
  - 응답:
    ```json
    {
      "success": true,
      "feedId": "string",
      "message": "이미지가 커뮤니티에 공유되었습니다."
    }
    ```

#### 🏷️ 메타데이터 관리
- **`GET /api/tags`**
  - 기능: 태그 자동완성을 위한 인기 태그 목록
  - 응답: 상위 50개 태그 (이름, 사용 횟수)
  
- **`GET /api/categories`**
  - 기능: 카테고리 목록 조회
  - 응답: 고정 카테고리 목록

### 🔹 데이터 처리 로직

#### 🔍 프롬프트 검증
- **금칙어 필터링**: 부적절한 콘텐츠 생성 방지
- **길이 제한**: 200자 이하 검증
- **특수문자 처리**: HTML 태그 제거, XSS 방지
- **언어 감지**: 한국어/영어 혼합 프롬프트 지원

#### 🖼️ 이미지 처리
- **AI 모델 호출**: Stable Diffusion 또는 DALL-E API 연동
- **썸네일 생성**: 원본 이미지에서 200x200px 썸네일 자동 생성
- **이미지 최적화**: WebP 포맷으로 변환, 압축률 85%
- **저장소 관리**: AWS S3 또는 GCP Storage에 저장

#### 👤 사용자 관리
- **생성 횟수 제한**: 일일 20회 무료, 프리미엄 사용자 100회
- **세션 관리**: 생성 중 중복 요청 방지
- **크레딧 시스템**: 무료 크레딧 소진 시 유료 구매 유도

---

## 4. 상태 관리 및 에러 처리

### 🔹 상태 관리 (Redux/Zustand)

#### 📊 전역 상태 구조
```typescript
interface ImageGenerationState {
  // 스타일 관련
  availableStyles: Style[];
  selectedStyle: Style | null;
  
  // 프롬프트 관련
  prompt: string;
  promptError: string | null;
  
  // 생성 관련
  isGenerating: boolean;
  generatedImages: GeneratedImage[];
  selectedImage: GeneratedImage | null;
  generationError: string | null;
  
  // 메타데이터 관련
  metadata: {
    title: string;
    description: string;
    tags: string[];
    category: string;
  };
  
  // 사용자 제한
  remainingCredits: number;
  dailyLimit: number;
}
```

### 🔹 에러 처리 시나리오

#### ❌ 프롬프트 관련 에러
- **200자 초과**: "프롬프트는 200자 이하로 입력해주세요."
- **금칙어 포함**: "부적절한 내용이 포함되어 있습니다. 다른 표현으로 수정해주세요."
- **빈 프롬프트**: "이미지 설명을 입력해주세요."

#### ❌ 생성 관련 에러
- **API 타임아웃**: "생성 시간이 초과되었습니다. 다시 시도해주세요."
- **서버 오류**: "일시적인 오류가 발생했습니다. 잠시 후 다시 시도해주세요."
- **크레딧 부족**: "일일 생성 한도를 초과했습니다. 내일 다시 시도하거나 프리미엄으로 업그레이드하세요."

#### ❌ 저장/공유 관련 에러
- **네트워크 오류**: "네트워크 연결을 확인하고 다시 시도해주세요."
- **권한 오류**: "로그인이 필요합니다."
- **파일 크기 초과**: "이미지 파일이 너무 큽니다."

---

## 5. 성능 최적화 및 사용자 경험

### 🔹 성능 최적화

#### ⚡ 로딩 최적화
- **스타일 데이터**: 페이지 로드 시 캐시된 데이터 사용
- **이미지 지연 로딩**: 생성된 이미지는 필요 시에만 로드
- **프리페칭**: 인기 스타일의 미리보기 이미지 사전 로드

#### 🖼️ 이미지 최적화
- **WebP 포맷**: 최신 브라우저에서 WebP, 구형 브라우저에서 JPEG
- **적응형 크기**: 화면 크기에 따른 이미지 해상도 조정
- **CDN 활용**: 이미지 전송 속도 향상

### 🔹 사용자 경험 개선

#### 🎨 시각적 피드백
- **로딩 애니메이션**: 생성 진행률을 시각적으로 표시
- **상태 표시**: 각 단계별 완료 상태를 명확히 표시
- **에러 메시지**: 사용자 친화적인 에러 메시지 제공

#### ⌨️ 접근성
- **키보드 네비게이션**: Tab 키로 모든 요소 접근 가능
- **스크린 리더**: ARIA 라벨 및 역할 정의
- **색상 대비**: WCAG 2.1 AA 기준 준수

---

## 6. 보안 및 정책

### 🔹 보안 조치

#### 🛡️ 입력 검증
- **XSS 방지**: HTML 태그 제거 및 이스케이프 처리
- **CSRF 보호**: 토큰 기반 요청 검증
- **Rate Limiting**: API 호출 빈도 제한

#### 🔒 데이터 보호
- **개인정보**: 사용자 ID만 저장, 개인정보 미수집
- **이미지 메타데이터**: 생성 시간, 사용자 ID, 프롬프트만 저장
- **임시 파일**: 생성 실패 시 임시 파일 자동 삭제

### 🔹 콘텐츠 정책

#### 📋 콘텐츠 가이드라인
- **금지 콘텐츠**: 성인 콘텐츠, 폭력, 혐오 표현 등
- **저작권**: 사용자 생성 콘텐츠의 저작권은 사용자에게 귀속
- **신고 시스템**: 부적절한 콘텐츠 신고 기능 제공

---

## 7. 테스트 시나리오

### 🔹 기능 테스트

#### ✅ 기본 플로우 테스트
1. **메인페이지 연동**: 프롬프트/스타일 전달 확인
2. **스타일 선택**: 25개 스타일 모두 선택 가능 확인
3. **프롬프트 입력**: 200자 제한, 실시간 검증 확인
4. **이미지 생성**: 4개 이미지 정상 생성 확인
5. **메타데이터 입력**: 모든 필드 정상 입력 확인
6. **저장/공유**: 갤러리 저장 및 피드 공유 확인

#### ✅ 에러 처리 테스트
1. **네트워크 오류**: 오프라인 상태에서 적절한 에러 메시지 표시
2. **API 오류**: 서버 오류 시 재시도 옵션 제공
3. **크레딧 부족**: 한도 초과 시 업그레이드 유도
4. **입력 검증**: 잘못된 입력에 대한 즉시 피드백

### 🔹 성능 테스트

#### ⚡ 로딩 시간
- **페이지 로드**: 3초 이내 완료
- **이미지 생성**: 60초 이내 완료
- **이미지 표시**: 2초 이내 렌더링

#### 📱 반응형 테스트
- **모바일**: 320px~768px 화면에서 정상 동작
- **태블릿**: 768px~1024px 화면에서 정상 동작
- **데스크톱**: 1024px 이상 화면에서 정상 동작

---

## ✅ 구현 우선순위

### 🔥 Phase 1 (핵심 기능)
1. 기본 레이아웃 및 스타일 선택
2. 프롬프트 입력 및 검증
3. AI 이미지 생성 API 연동
4. 생성 결과 표시 및 선택

### 🔥 Phase 2 (메타데이터 및 저장)
1. 메타데이터 입력 폼
2. 갤러리 저장 기능
3. 커뮤니티 공유 기능
4. 에러 처리 및 피드백

### 🔥 Phase 3 (최적화 및 개선)
1. 성능 최적화
2. 접근성 개선
3. 고급 기능 (태그 자동완성, 카테고리 관리)
4. 사용자 경험 개선

---

## 📋 협업 필요 사항

### 🔗 프론트엔드-백엔드 연동
- **API 스펙 정의**: 요청/응답 형식 상세 정의
- **에러 코드 표준화**: 공통 에러 코드 및 메시지 정의
- **인증 시스템**: JWT 토큰 기반 인증 방식 협의

### 🎨 디자인 시스템
- **컴포넌트 라이브러리**: 재사용 가능한 UI 컴포넌트 정의
- **반응형 브레이크포인트**: 모바일/태블릿/데스크톱 기준점 설정
- **애니메이션 가이드**: 일관된 애니메이션 효과 정의

### 🔧 인프라 및 배포
- **이미지 저장소**: AWS S3 또는 GCP Storage 설정
- **CDN 설정**: 이미지 전송 최적화
- **모니터링**: 에러 추적 및 성능 모니터링 도구 설정
